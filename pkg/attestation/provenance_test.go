//
// Copyright 2023 Stacklok, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package attestation

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

const provenance = `{
	"payloadType": "application/vnd.in-toto+json",
	"payload": "eyJfdHlwZSI6Imh0dHBzOi8vaW4tdG90by5pby9TdGF0ZW1lbnQvdjAuMSIsInByZWRpY2F0ZVR5cGUiOiJodHRwczovL3Nsc2EuZGV2L3Byb3ZlbmFuY2UvdjAuMiIsInN1YmplY3QiOlt7Im5hbWUiOiJzbHNhLXZlcmlmaWVyLWxpbnV4LWFtZDY0IiwiZGlnZXN0Ijp7InNoYTI1NiI6ImIxZDZjOWJiY2U2Mjc0ZTI1M2YwYmUzMzE1OGNhY2Q3ZmI4OTRjNWViZDY0M2YxNGE5MTFiZmU1NTU3NGY0YzAifX1dLCJwcmVkaWNhdGUiOnsiYnVpbGRlciI6eyJpZCI6Imh0dHBzOi8vZ2l0aHViLmNvbS9zbHNhLWZyYW1ld29yay9zbHNhLWdpdGh1Yi1nZW5lcmF0b3IvLmdpdGh1Yi93b3JrZmxvd3MvYnVpbGRlcl9nb19zbHNhMy55bWxAcmVmcy90YWdzL3YxLjIuMSJ9LCJidWlsZFR5cGUiOiJodHRwczovL2dpdGh1Yi5jb20vc2xzYS1mcmFtZXdvcmsvc2xzYS1naXRodWItZ2VuZXJhdG9yL2dvQHYxIiwiaW52b2NhdGlvbiI6eyJjb25maWdTb3VyY2UiOnsidXJpIjoiZ2l0K2h0dHBzOi8vZ2l0aHViLmNvbS9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyQHJlZnMvdGFncy92MS4zLjIiLCJkaWdlc3QiOnsic2hhMSI6IjBmZjY2NTYxNWIyMDIxYmJkNjQ3NjIyNjU4NDZiYWNlNjA2ZTA5MDQifSwiZW50cnlQb2ludCI6Ii5naXRodWIvd29ya2Zsb3dzL3JlbGVhc2UueW1sIn0sInBhcmFtZXRlcnMiOnt9LCJlbnZpcm9ubWVudCI6eyJhcmNoIjoiWDY0IiwiZ2l0aHViX2FjdG9yIjoiYXNyYWEiLCJnaXRodWJfYWN0b3JfaWQiOiI1MTk0NTY5IiwiZ2l0aHViX2Jhc2VfcmVmIjoiIiwiZ2l0aHViX2V2ZW50X25hbWUiOiJwdXNoIiwiZ2l0aHViX2V2ZW50X3BheWxvYWQiOnsiYWZ0ZXIiOiIwZmY2NjU2MTViMjAyMWJiZDY0NzYyMjY1ODQ2YmFjZTYwNmUwOTA0IiwiYmFzZV9yZWYiOiJyZWZzL2hlYWRzL3JlbGVhc2UvdjEuMyIsImJlZm9yZSI6IjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiLCJjb21taXRzIjpbXSwiY29tcGFyZSI6Imh0dHBzOi8vZ2l0aHViLmNvbS9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2NvbXBhcmUvdjEuMy4yIiwiY3JlYXRlZCI6dHJ1ZSwiZGVsZXRlZCI6ZmFsc2UsImZvcmNlZCI6ZmFsc2UsImhlYWRfY29tbWl0Ijp7ImF1dGhvciI6eyJlbWFpbCI6ImFzcmFhQGdvb2dsZS5jb20iLCJuYW1lIjoiYXNyYWEiLCJ1c2VybmFtZSI6ImFzcmFhIn0sImNvbW1pdHRlciI6eyJlbWFpbCI6Im5vcmVwbHlAZ2l0aHViLmNvbSIsIm5hbWUiOiJHaXRIdWIiLCJ1c2VybmFtZSI6IndlYi1mbG93In0sImRpc3RpbmN0Ijp0cnVlLCJpZCI6IjBmZjY2NTYxNWIyMDIxYmJkNjQ3NjIyNjU4NDZiYWNlNjA2ZTA5MDQiLCJtZXNzYWdlIjoicmVsZWFzZS92MS4zOiB1cGRhdGUgcmVsZWFzZSBidWlsZGVyICgjMzMzKVxuXG5TaWduZWQtb2ZmLWJ5OiBBc3JhIEFsaSBcdTAwM2Nhc3JhYUBnb29nbGUuY29tXHUwMDNlXHJcblxyXG5TaWduZWQtb2ZmLWJ5OiBBc3JhIEFsaSBcdTAwM2Nhc3JhYUBnb29nbGUuY29tXHUwMDNlIiwidGltZXN0YW1wIjoiMjAyMi0xMC0yOFQwNzo1Mzo0OC0wNzowMCIsInRyZWVfaWQiOiI2NzYzOTBkODIyMWQ3NDg0Y2Q5NzcwNjEwNTMzZWIwYThhZDNkNjE5IiwidXJsIjoiaHR0cHM6Ly9naXRodWIuY29tL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvY29tbWl0LzBmZjY2NTYxNWIyMDIxYmJkNjQ3NjIyNjU4NDZiYWNlNjA2ZTA5MDQifSwib3JnYW5pemF0aW9uIjp7ImF2YXRhcl91cmwiOiJodHRwczovL2F2YXRhcnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3UvODA0MzExODc/dj00IiwiZGVzY3JpcHRpb24iOiJTdXBwbHktY2hhaW4gTGV2ZWxzIGZvciBTb2Z0d2FyZSBBcnRpZmFjdHMiLCJldmVudHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9vcmdzL3Nsc2EtZnJhbWV3b3JrL2V2ZW50cyIsImhvb2tzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vb3Jncy9zbHNhLWZyYW1ld29yay9ob29rcyIsImlkIjo4MDQzMTE4NywiaXNzdWVzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vb3Jncy9zbHNhLWZyYW1ld29yay9pc3N1ZXMiLCJsb2dpbiI6InNsc2EtZnJhbWV3b3JrIiwibWVtYmVyc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL29yZ3Mvc2xzYS1mcmFtZXdvcmsvbWVtYmVyc3svbWVtYmVyfSIsIm5vZGVfaWQiOiJNREV5T2s5eVoyRnVhWHBoZEdsdmJqZ3dORE14TVRnMyIsInB1YmxpY19tZW1iZXJzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vb3Jncy9zbHNhLWZyYW1ld29yay9wdWJsaWNfbWVtYmVyc3svbWVtYmVyfSIsInJlcG9zX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vb3Jncy9zbHNhLWZyYW1ld29yay9yZXBvcyIsInVybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vb3Jncy9zbHNhLWZyYW1ld29yayJ9LCJwdXNoZXIiOnsiZW1haWwiOiJhc3JhYUBnb29nbGUuY29tIiwibmFtZSI6ImFzcmFhIn0sInJlZiI6InJlZnMvdGFncy92MS4zLjIiLCJyZXBvc2l0b3J5Ijp7ImFsbG93X2ZvcmtpbmciOnRydWUsImFyY2hpdmVfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL3thcmNoaXZlX2Zvcm1hdH17L3JlZn0iLCJhcmNoaXZlZCI6ZmFsc2UsImFzc2lnbmVlc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvYXNzaWduZWVzey91c2VyfSIsImJsb2JzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mvc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci9naXQvYmxvYnN7L3NoYX0iLCJicmFuY2hlc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvYnJhbmNoZXN7L2JyYW5jaH0iLCJjbG9uZV91cmwiOiJodHRwczovL2dpdGh1Yi5jb20vc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci5naXQiLCJjb2xsYWJvcmF0b3JzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mvc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci9jb2xsYWJvcmF0b3Jzey9jb2xsYWJvcmF0b3J9IiwiY29tbWVudHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2NvbW1lbnRzey9udW1iZXJ9IiwiY29tbWl0c191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvY29tbWl0c3svc2hhfSIsImNvbXBhcmVfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2NvbXBhcmUve2Jhc2V9Li4ue2hlYWR9IiwiY29udGVudHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2NvbnRlbnRzL3srcGF0aH0iLCJjb250cmlidXRvcnNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2NvbnRyaWJ1dG9ycyIsImNyZWF0ZWRfYXQiOjE2NDgyNDIxMDcsImRlZmF1bHRfYnJhbmNoIjoibWFpbiIsImRlcGxveW1lbnRzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mvc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci9kZXBsb3ltZW50cyIsImRlc2NyaXB0aW9uIjpudWxsLCJkaXNhYmxlZCI6ZmFsc2UsImRvd25sb2Fkc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvZG93bmxvYWRzIiwiZXZlbnRzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mvc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci9ldmVudHMiLCJmb3JrIjpmYWxzZSwiZm9ya3MiOjE5LCJmb3Jrc19jb3VudCI6MTksImZvcmtzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mvc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci9mb3JrcyIsImZ1bGxfbmFtZSI6InNsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIiLCJnaXRfY29tbWl0c191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvZ2l0L2NvbW1pdHN7L3NoYX0iLCJnaXRfcmVmc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvZ2l0L3JlZnN7L3NoYX0iLCJnaXRfdGFnc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvZ2l0L3RhZ3N7L3NoYX0iLCJnaXRfdXJsIjoiZ2l0Oi8vZ2l0aHViLmNvbS9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyLmdpdCIsImhhc19kb3dubG9hZHMiOnRydWUsImhhc19pc3N1ZXMiOnRydWUsImhhc19wYWdlcyI6ZmFsc2UsImhhc19wcm9qZWN0cyI6dHJ1ZSwiaGFzX3dpa2kiOnRydWUsImhvbWVwYWdlIjpudWxsLCJob29rc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvaG9va3MiLCJodG1sX3VybCI6Imh0dHBzOi8vZ2l0aHViLmNvbS9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyIiwiaWQiOjQ3NDE2MjY0MiwiaXNfdGVtcGxhdGUiOmZhbHNlLCJpc3N1ZV9jb21tZW50X3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mvc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci9pc3N1ZXMvY29tbWVudHN7L251bWJlcn0iLCJpc3N1ZV9ldmVudHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2lzc3Vlcy9ldmVudHN7L251bWJlcn0iLCJpc3N1ZXNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2lzc3Vlc3svbnVtYmVyfSIsImtleXNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2tleXN7L2tleV9pZH0iLCJsYWJlbHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL2xhYmVsc3svbmFtZX0iLCJsYW5ndWFnZSI6IkdvIiwibGFuZ3VhZ2VzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3Mvc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci9sYW5ndWFnZXMiLCJsaWNlbnNlIjp7ImtleSI6ImFwYWNoZS0yLjAiLCJuYW1lIjoiQXBhY2hlIExpY2Vuc2UgMi4wIiwibm9kZV9pZCI6Ik1EYzZUR2xqWlc1elpUST0iLCJzcGR4X2lkIjoiQXBhY2hlLTIuMCIsInVybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vbGljZW5zZXMvYXBhY2hlLTIuMCJ9LCJtYXN0ZXJfYnJhbmNoIjoibWFpbiIsIm1lcmdlc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvbWVyZ2VzIiwibWlsZXN0b25lc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvbWlsZXN0b25lc3svbnVtYmVyfSIsIm1pcnJvcl91cmwiOm51bGwsIm5hbWUiOiJzbHNhLXZlcmlmaWVyIiwibm9kZV9pZCI6IlJfa2dET0hFTWwwZyIsIm5vdGlmaWNhdGlvbnNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL25vdGlmaWNhdGlvbnN7P3NpbmNlLGFsbCxwYXJ0aWNpcGF0aW5nfSIsIm9wZW5faXNzdWVzIjo1OSwib3Blbl9pc3N1ZXNfY291bnQiOjU5LCJvcmdhbml6YXRpb24iOiJzbHNhLWZyYW1ld29yayIsIm93bmVyIjp7ImF2YXRhcl91cmwiOiJodHRwczovL2F2YXRhcnMuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3UvODA0MzExODc/dj00IiwiZW1haWwiOm51bGwsImV2ZW50c191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL3Nsc2EtZnJhbWV3b3JrL2V2ZW50c3svcHJpdmFjeX0iLCJmb2xsb3dlcnNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9zbHNhLWZyYW1ld29yay9mb2xsb3dlcnMiLCJmb2xsb3dpbmdfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9zbHNhLWZyYW1ld29yay9mb2xsb3dpbmd7L290aGVyX3VzZXJ9IiwiZ2lzdHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9zbHNhLWZyYW1ld29yay9naXN0c3svZ2lzdF9pZH0iLCJncmF2YXRhcl9pZCI6IiIsImh0bWxfdXJsIjoiaHR0cHM6Ly9naXRodWIuY29tL3Nsc2EtZnJhbWV3b3JrIiwiaWQiOjgwNDMxMTg3LCJsb2dpbiI6InNsc2EtZnJhbWV3b3JrIiwibmFtZSI6InNsc2EtZnJhbWV3b3JrIiwibm9kZV9pZCI6Ik1ERXlPazl5WjJGdWFYcGhkR2x2Ympnd05ETXhNVGczIiwib3JnYW5pemF0aW9uc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL3Nsc2EtZnJhbWV3b3JrL29yZ3MiLCJyZWNlaXZlZF9ldmVudHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9zbHNhLWZyYW1ld29yay9yZWNlaXZlZF9ldmVudHMiLCJyZXBvc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL3Nsc2EtZnJhbWV3b3JrL3JlcG9zIiwic2l0ZV9hZG1pbiI6ZmFsc2UsInN0YXJyZWRfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9zbHNhLWZyYW1ld29yay9zdGFycmVkey9vd25lcn17L3JlcG99Iiwic3Vic2NyaXB0aW9uc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL3Nsc2EtZnJhbWV3b3JrL3N1YnNjcmlwdGlvbnMiLCJ0eXBlIjoiT3JnYW5pemF0aW9uIiwidXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9zbHNhLWZyYW1ld29yayJ9LCJwcml2YXRlIjpmYWxzZSwicHVsbHNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL3B1bGxzey9udW1iZXJ9IiwicHVzaGVkX2F0IjoxNjY3MjQ0Njk5LCJyZWxlYXNlc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvcmVsZWFzZXN7L2lkfSIsInNpemUiOjQ2OTAwLCJzc2hfdXJsIjoiZ2l0QGdpdGh1Yi5jb206c2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllci5naXQiLCJzdGFyZ2F6ZXJzIjo1MCwic3RhcmdhemVyc19jb3VudCI6NTAsInN0YXJnYXplcnNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL3N0YXJnYXplcnMiLCJzdGF0dXNlc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvc3RhdHVzZXMve3NoYX0iLCJzdWJzY3JpYmVyc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvc3Vic2NyaWJlcnMiLCJzdWJzY3JpcHRpb25fdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL3N1YnNjcmlwdGlvbiIsInN2bl91cmwiOiJodHRwczovL2dpdGh1Yi5jb20vc2xzYS1mcmFtZXdvcmsvc2xzYS12ZXJpZmllciIsInRhZ3NfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyL3RhZ3MiLCJ0ZWFtc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvdGVhbXMiLCJ0b3BpY3MiOltdLCJ0cmVlc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIvZ2l0L3RyZWVzey9zaGF9IiwidXBkYXRlZF9hdCI6IjIwMjItMTAtMjVUMTQ6NTQ6NDRaIiwidXJsIjoiaHR0cHM6Ly9naXRodWIuY29tL3Nsc2EtZnJhbWV3b3JrL3Nsc2EtdmVyaWZpZXIiLCJ2aXNpYmlsaXR5IjoicHVibGljIiwid2F0Y2hlcnMiOjUwLCJ3YXRjaGVyc19jb3VudCI6NTAsIndlYl9jb21taXRfc2lnbm9mZl9yZXF1aXJlZCI6dHJ1ZX0sInNlbmRlciI6eyJhdmF0YXJfdXJsIjoiaHR0cHM6Ly9hdmF0YXJzLmdpdGh1YnVzZXJjb250ZW50LmNvbS91LzUxOTQ1Njk/dj00IiwiZXZlbnRzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlcnMvYXNyYWEvZXZlbnRzey9wcml2YWN5fSIsImZvbGxvd2Vyc191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL2FzcmFhL2ZvbGxvd2VycyIsImZvbGxvd2luZ191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL2FzcmFhL2ZvbGxvd2luZ3svb3RoZXJfdXNlcn0iLCJnaXN0c191cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL2FzcmFhL2dpc3Rzey9naXN0X2lkfSIsImdyYXZhdGFyX2lkIjoiIiwiaHRtbF91cmwiOiJodHRwczovL2dpdGh1Yi5jb20vYXNyYWEiLCJpZCI6NTE5NDU2OSwibG9naW4iOiJhc3JhYSIsIm5vZGVfaWQiOiJNRFE2VlhObGNqVXhPVFExTmprPSIsIm9yZ2FuaXphdGlvbnNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9hc3JhYS9vcmdzIiwicmVjZWl2ZWRfZXZlbnRzX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlcnMvYXNyYWEvcmVjZWl2ZWRfZXZlbnRzIiwicmVwb3NfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9hc3JhYS9yZXBvcyIsInNpdGVfYWRtaW4iOmZhbHNlLCJzdGFycmVkX3VybCI6Imh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlcnMvYXNyYWEvc3RhcnJlZHsvb3duZXJ9ey9yZXBvfSIsInN1YnNjcmlwdGlvbnNfdXJsIjoiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy9hc3JhYS9zdWJzY3JpcHRpb25zIiwidHlwZSI6IlVzZXIiLCJ1cmwiOiJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzL2FzcmFhIn19LCJnaXRodWJfaGVhZF9yZWYiOiIiLCJnaXRodWJfcmVmIjoicmVmcy90YWdzL3YxLjMuMiIsImdpdGh1Yl9yZWZfdHlwZSI6InRhZyIsImdpdGh1Yl9yZXBvc2l0b3J5X2lkIjoiNDc0MTYyNjQyIiwiZ2l0aHViX3JlcG9zaXRvcnlfb3duZXIiOiJzbHNhLWZyYW1ld29yayIsImdpdGh1Yl9yZXBvc2l0b3J5X293bmVyX2lkIjoiODA0MzExODciLCJnaXRodWJfcnVuX2F0dGVtcHQiOiIxIiwiZ2l0aHViX3J1bl9pZCI6IjMzNjQxNzM3MzEiLCJnaXRodWJfcnVuX251bWJlciI6IjExMSIsImdpdGh1Yl9zaGExIjoiMGZmNjY1NjE1YjIwMjFiYmQ2NDc2MjI2NTg0NmJhY2U2MDZlMDkwNCIsIm9zIjoidWJ1bnR1MjAifX0sImJ1aWxkQ29uZmlnIjp7InZlcnNpb24iOjEsInN0ZXBzIjpbeyJjb21tYW5kIjpbIi9vcHQvaG9zdGVkdG9vbGNhY2hlL2dvLzEuMTguNy94NjQvYmluL2dvIiwibW9kIiwidmVuZG9yIl0sImVudiI6bnVsbCwid29ya2luZ0RpciI6Ii9ob21lL3J1bm5lci93b3JrL3Nsc2EtdmVyaWZpZXIvc2xzYS12ZXJpZmllci9jbGkvc2xzYS12ZXJpZmllciJ9LHsiY29tbWFuZCI6WyIvb3B0L2hvc3RlZHRvb2xjYWNoZS9nby8xLjE4LjcveDY0L2Jpbi9nbyIsImJ1aWxkIiwiLW1vZD12ZW5kb3IiLCItdHJpbXBhdGgiLCItdGFncz1uZXRnbyIsIi1vIiwic2xzYS12ZXJpZmllci1saW51eC1hbWQ2NCJdLCJlbnYiOlsiR09PUz1saW51eCIsIkdPQVJDSD1hbWQ2NCIsIkdPMTExTU9EVUxFPW9uIiwiQ0dPX0VOQUJMRUQ9MCJdLCJ3b3JraW5nRGlyIjoiL2hvbWUvcnVubmVyL3dvcmsvc2xzYS12ZXJpZmllci9zbHNhLXZlcmlmaWVyL2NsaS9zbHNhLXZlcmlmaWVyIn1dfSwibWV0YWRhdGEiOnsiYnVpbGRJbnZvY2F0aW9uSUQiOiIzMzY0MTczNzMxLTEiLCJjb21wbGV0ZW5lc3MiOnsicGFyYW1ldGVycyI6dHJ1ZSwiZW52aXJvbm1lbnQiOmZhbHNlLCJtYXRlcmlhbHMiOmZhbHNlfSwicmVwcm9kdWNpYmxlIjpmYWxzZX0sIm1hdGVyaWFscyI6W3sidXJpIjoiZ2l0K2h0dHBzOi8vZ2l0aHViLmNvbS9zbHNhLWZyYW1ld29yay9zbHNhLXZlcmlmaWVyQHJlZnMvdGFncy92MS4zLjIiLCJkaWdlc3QiOnsic2hhMSI6IjBmZjY2NTYxNWIyMDIxYmJkNjQ3NjIyNjU4NDZiYWNlNjA2ZTA5MDQifX0seyJ1cmkiOiJodHRwczovL2dpdGh1Yi5jb20vYWN0aW9ucy92aXJ0dWFsLWVudmlyb25tZW50cy9yZWxlYXNlcy90YWcvdWJ1bnR1MjAvMjAyMjEwMjQuMSJ9XX19",
	"signatures": [
	  {
		"keyid": "",
		"sig": "MEQCIAO5rdahLHyeLEjxz5Oi8DKF40taFQnzYQcU5zdx0kcpAiBqIGlVr5mtshn+tOH9NNrTV3gIUy6N94qosmg9KgYn6A==",
		"cert": "-----BEGIN CERTIFICATE-----\nMIIDxTCCA0ugAwIBAgIUXuKDhF+IiU97t4N2WmFT+Mm0ZjAwCgYIKoZIzj0EAwMw\nNzEVMBMGA1UEChMMc2lnc3RvcmUuZGV2MR4wHAYDVQQDExVzaWdzdG9yZS1pbnRl\ncm1lZGlhdGUwHhcNMjIxMDMxMTkzOTAwWhcNMjIxMDMxMTk0OTAwWjAAMFkwEwYH\nKoZIzj0CAQYIKoZIzj0DAQcDQgAEPkrMWXn7j4cyjuqhIvqX4e9hACVDrXEpV9Yo\naJkfvrA+elQyO2le/ix+zWjCiM9QTktTyxVrueWwZwZayZ9AN6OCAmowggJmMA4G\nA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEFBQcDAzAdBgNVHQ4EFgQU6q4X\nX0g0N4v+ou4SaGiZJOmEWCgwHwYDVR0jBBgwFoAU39Ppz1YkEZb5qNjpKFWixi4Y\nZD8wfQYDVR0RAQH/BHMwcYZvaHR0cHM6Ly9naXRodWIuY29tL3Nsc2EtZnJhbWV3\nb3JrL3Nsc2EtZ2l0aHViLWdlbmVyYXRvci8uZ2l0aHViL3dvcmtmbG93cy9idWls\nZGVyX2dvX3Nsc2EzLnltbEByZWZzL3RhZ3MvdjEuMi4xMDkGCisGAQQBg78wAQEE\nK2h0dHBzOi8vdG9rZW4uYWN0aW9ucy5naXRodWJ1c2VyY29udGVudC5jb20wEgYK\nKwYBBAGDvzABAgQEcHVzaDA2BgorBgEEAYO/MAEDBCgwZmY2NjU2MTViMjAyMWJi\nZDY0NzYyMjY1ODQ2YmFjZTYwNmUwOTA0MB8GCisGAQQBg78wAQQEEVZlcmlmaWVy\nIHJlbGVhc2VyMCoGCisGAQQBg78wAQUEHHNsc2EtZnJhbWV3b3JrL3Nsc2EtdmVy\naWZpZXIwHgYKKwYBBAGDvzABBgQQcmVmcy90YWdzL3YxLjMuMjCBiwYKKwYBBAHW\neQIEAgR9BHsAeQB3AN09MGrGxxEyYxkeHJlnNwKiSl643jyt/4eKcoAvKe6OAAAB\nhC+N6N8AAAQDAEgwRgIhAIiqj3f+7dYambTE1eT9vvZ7K6DvD8EGfM/Gf1Ldfb1R\nAiEA9UkauyRbrnAA8hAg17FcrdShUFTpiTadcsxlMnfSP1gwCgYIKoZIzj0EAwMD\naAAwZQIxAK7j0MDi8i7DvxlLrhPY0TXv/FSv/BJvmTeCbPUD+X9Ls69iaSACWm3Y\n960UGxVPKAIwcEpvVrmNFIzdmgYREuWIN2++X/1w2AiqBAXj4iVsBWiPAo/NzxFY\nnBEw/a+i7Rlh\n-----END CERTIFICATE-----\n"
	  }
	]
  }`

func TestUnMarshallAnGetPayload(t *testing.T) {
	prov, err := UnmarshalProvenance([]byte(provenance))
	if err != nil {
		t.Fatal(err)
	}
	assert.Contains(t, prov.Payload, "eyJfdHlwZSI6Imh0dHB", "payload should contain the expected value")
}
