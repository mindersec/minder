---
# sample policy for validating repositories
version: v1
type: pipeline-policy
name: acme-github-policy
context:
  group: Root Group
  provider: github
repository:
  - context: github
    rules:
      - type: secret_scanning
        def:
          enabled: true
      - type: secret_push_protection
        def:
          enabled: true
      - type: branch_protection
        params:
          branch: main
        def:
          required_pull_request_reviews:
            dismiss_stale_reviews: true
            require_code_owner_reviews: true
            required_approving_review_count: 1
          required_linear_history: true
          allow_force_pushes: false
          allow_deletions: false
          allow_fork_syncing: true
      - type: actions_permissions
        def:
          enabled: true
          allowed_actions: selected
      - type: artifact_signature
        def:
          is_signed: true
# build_environment:
#   - rules:  # Not specifying a context takes the default context
#       - type: no_org_wide_github_action_permissions
#         def:
#           enabled: true
# artifact:
#   - context: github
#     rules:
#       - type: ctlog_entry
#         params:
#           rekor: 'https://rekor.acme.dev/'
#           fulcio: 'https://fulcio.acme.dev/'
#           tuf: 'https://tuf.acme.dev/'
#         def:
#           state: exists
#   - context: quay
#     rules:
#       - type: ctlog_entry
#         params:
#           rekor: 'https://rekor.acme.dev/'
#           fulcio: 'https://fulcio.acme.dev/'
#           tuf: 'https://tuf.acme.dev/'
#         def:
#           state: exists
