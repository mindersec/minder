---
#Â sample policy for validating artifact signatures
version: v1
type: pipeline-policy
name: acme-github-policy-artifact
context:
  group: Root Group
  provider: github
artifact:
  - context: artifact_version
    params:
      name: myartifact
      tag: latest  # TODO: OCI "tag" conflicts with git "tag"
      # TODO: need better matching: semver expression?
    rules:
      - property: signature.exists
        value: true
      - property: signature.verified
        value: true
      - property: signature.metadata[WorkflowName]
        value: "myorg/myrepo/myworkflow"
      - property: signature.metadata[WorkflowTrigger]
        glob: "something*" # prefix match
      - property: signature.metadata[WorkflowSha]
        exists: true
