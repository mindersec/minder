<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-ref/rule_evaluation_details" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Rule Evaluation in Depth | Minder docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://minder-docs.stacklok.dev/img/Minder_darkMode.png"><meta data-rh="true" name="twitter:image" content="https://minder-docs.stacklok.dev/img/Minder_darkMode.png"><meta data-rh="true" property="og:url" content="https://minder-docs.stacklok.dev/ref/rule_evaluation_details"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rule Evaluation in Depth | Minder docs"><meta data-rh="true" name="description" content="When evaluating a rule,"><meta data-rh="true" property="og:description" content="When evaluating a rule,"><link data-rh="true" rel="icon" href="/img/stacklok-favicon.png"><link data-rh="true" rel="canonical" href="https://minder-docs.stacklok.dev/ref/rule_evaluation_details"><link data-rh="true" rel="alternate" href="https://minder-docs.stacklok.dev/ref/rule_evaluation_details" hreflang="en"><link data-rh="true" rel="alternate" href="https://minder-docs.stacklok.dev/ref/rule_evaluation_details" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://F7OP01WFHV-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Rule Evaluation in Depth","item":"https://minder-docs.stacklok.dev/ref/rule_evaluation_details"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Minder docs" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.bb2bc5dc.css">
<script src="/assets/js/runtime~main.7137e20f.js" defer="defer"></script>
<script src="/assets/js/main.a7619c2a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="dark";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/Minder-whitetxt.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Minder-whitetxt.svg" alt="Minder Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Minder-whitetxt.svg" alt="Minder Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Minder docs</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/mindersec/minder" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/getting_started/install_cli">Getting started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/understand/key_concepts">How Minder works</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/how-to/create_profile">Policy and profile management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/developer_guide/get-hacking">Developer guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/user_management/adding_users">User management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/integrations/overview">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/run_minder_server/intro_to_install">Run a Minder server</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/ref/cli_configuration">Reference</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ref/cli_configuration">Minder CLI configuration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ref/cli/minder">CLI Commands</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ref/api">REST API documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ref/proto">Protocol documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ref/rules/artifact_signature">Rules</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ref/schema">Minder database schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ref/rule_evaluation_details">Rule Evaluation in Depth</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/about/changelog">About Minder</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Rule Evaluation in Depth</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Rule Evaluation in Depth</h1></header>
<p>When evaluating a rule,
<a href="https://mindersec.github.io/understand/key_concepts#phases-of-evaluation" target="_blank" rel="noopener noreferrer">Minder executes the rule in multiple phases</a>.
This page contains detailed documentation about the execution of each phase.
Minder performs rule evaluation across all relevant policies when it detects
that an entity has changed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ingest">Ingest<a href="#ingest" class="hash-link" aria-label="Direct link to Ingest" title="Direct link to Ingest">​</a></h2>
<p>The ingest phase in Minder is where the system gathers and processes information
about entities before policy evaluation. Here&#x27;s a breakdown:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="input-sources">Input Sources:<a href="#input-sources" class="hash-link" aria-label="Direct link to Input Sources:" title="Direct link to Input Sources:">​</a></h3>
<p>The primary input is the <code>Entity</code> object representing the entity that the policy
rules apply to. The <code>Entity</code> objects have specific properties based on the type
of entity:</p>
<ul>
<li><a href="/ref/proto#minder-v1-Repository">Repository</a></li>
<li><a href="https://github.com/mindersec/minder/tree/main/internal/providers/github/properties/pull_request.go" target="_blank" rel="noopener noreferrer">Pull Request</a></li>
</ul>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ingest-types-and-their-outputs">Ingest Types and Their Outputs<a href="#ingest-types-and-their-outputs" class="hash-link" aria-label="Direct link to Ingest Types and Their Outputs" title="Direct link to Ingest Types and Their Outputs">​</a></h3>
<p>Each rule can specify the type of data which should be ingested. Minder works to
cache ingested data across all rule evaluations, so multiple rules which ingest
the same data should only need to fetch it once. The ingestion types produce the
following data for rule evaluatino:</p>
<ol>
<li>
<p><strong>REST Ingest</strong> (<code>rest</code>)</p>
<p><em>Entity Types</em>: all types</p>
<p><em>Data Content</em>: Calls a REST endpoint specified in the ingest type, and
returns a parsed JSON object from the response</p>
</li>
<li>
<p><strong>Git Ingest</strong> (<code>git</code>)</p>
<p><em>Entity_Types</em>: PRs and repos</p>
<p><em>Data Content</em>: This is only useful with the Rego evaluation engine. It
provides a filesystem view of the current repository contents; this is
required for using the Rego <code>fs</code> methods.</p>
</li>
<li>
<p><strong>Dependency Ingest</strong> (<code>deps</code>)</p>
<p><em>Entity_Types</em>: PRs and repos</p>
<p><em>Data Content</em>: Ingests the set of libraries used by recognized package
managers, using the <a href="https://github.com/google/osv-scalibr" target="_blank" rel="noopener noreferrer">osv-scalibr</a>
library. When used to ingest a pull request, the <code>deps</code> ingest can provide
<code>new</code>, <code>new_and_updated</code>, or <code>all</code> dependencies from the repository after the
proposed change.</p>
</li>
<li>
<p><strong>Artifact Ingest</strong> (<code>artifact</code>)</p>
<p><em>Entity_Types</em>: artifact</p>
<p><em>Data Content</em>: Fetches details about about container build attestations,
including signature data, branch and repository information, and GitHub
runner environment.</p>
</li>
<li>
<p><strong>Diff Ingest</strong> (<code>diff</code>)</p>
<p><em>Entity_Types</em>: PR only</p>
<p><em>Data Content</em>: Provides a set of diffs describing the changes proposed in
the PR. This works with the <code>homoglyphs</code> and <code>vulncheck</code> evaluators. The diff
can evaluate <code>full</code> (all files) and <code>dep</code> (dependency changes) for these
evaluators.</p>
<!-- -->
</li>
</ol>
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evaluate">Evaluate<a href="#evaluate" class="hash-link" aria-label="Direct link to Evaluate" title="Direct link to Evaluate">​</a></h2>
<p>The evaluation phase in Minder evaluates the ingested data according to the
<a href="https://mindersec.github.io/ref/proto#minder-v1-RuleType-Definition-Eval" target="_blank" rel="noopener noreferrer">specified rule type and parameters</a>.
Here&#x27;s how it works:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="evaluation-process">Evaluation Process<a href="#evaluation-process" class="hash-link" aria-label="Direct link to Evaluation Process" title="Direct link to Evaluation Process">​</a></h3>
<p>Minder takes the following inputs for rule evaluation:</p>
<ul>
<li>Ingested data from the <a href="#ingest">ingest phase</a></li>
<li>Rule profile parameters from the <code>params</code> and <code>def</code> clauses.</li>
<li>Entity properties as string key-value pairs (e.g.,
<code>github/default_branch=main</code>)</li>
</ul>
<p>The system then evaluates the rule using one of these engines:</p>
<ol>
<li>
<p><strong>Rego Evaluation</strong> (<code>rego</code>)</p>
<p>See the
<a href="/how-to/writing-rules-in-rego">documentation on writing rules for Rego</a>
for more details on the Rego evaluation engine. This engine has the most
flexibility and supports sophisticated logic, but also has a higher learning
curve.</p>
<ul>
<li>Uses <a href="https://www.openpolicyagent.org/" target="_blank" rel="noopener noreferrer">Open Policy Agent</a> (OPA) Rego
language</li>
<li>Supports two evaluation modes:<!-- -->
<ul>
<li><code>deny-by-default</code>: Rule fails unless <code>allow := true</code> is set</li>
<li><code>constraints</code>: Rule fails if the <code>violations</code> array contains any entries.
<code>violations</code> elements must be an object which contains a <code>msg</code> key, e.g.
<code>violations := [{&quot;msg&quot;: &quot;...&quot;}, {&quot;msg&quot;: &quot;...&quot;}]</code></li>
</ul>
</li>
<li>Produces output via the <code>output</code> property in the Rego code</li>
</ul>
</li>
<li>
<p><strong>JQ Evaluation</strong> (<code>jq</code>)</p>
<p>See the
<a href="/how-to/writing-rules-in-jq">documentation on writing rules in JQ</a> for
more details on the JQ evaluation engine. This engine allows you to easily
extract structured data and compare it with known or expected values.</p>
<ul>
<li>Processes JSON data using <a href="https://stedolan.github.io/jq/" target="_blank" rel="noopener noreferrer">jq queries</a></li>
<li>Returns evaluation results based on the query output</li>
</ul>
</li>
<li>
<p><strong>Vulncheck Evaluation</strong> (<code>vulncheck</code>)</p>
<p>See the
<a href="/integrations/community_integrations">documentation on checking vulnerabilities</a>
for more details on the vulncheck engine. The vulncheck engine is a
custom-coded engine which evaluates software dependencies against the
<a href="https://osv.dev/" target="_blank" rel="noopener noreferrer">Open Source Vulnerabilities (OSV) database</a>. With
improvements to the <code>deps</code> ingestion type, this evaluator can largely be
replaced with rego evaluation and
<a href="/understand/data_sources">data sources</a>.</p>
<ul>
<li>Requires the use of the <code>diff</code> ingestion type with specified <code>ecosystems</code>,
and only operates in a <code>pull_request</code> context</li>
<li>Uses a custom parser for dependency files, and can suggest line-level
comments on vulnerable libraries</li>
<li>Immediately applies comments highlighting new vulnerable libraries when
evaluated against a pull request.</li>
</ul>
</li>
<li>
<p><strong>Homoglyph Evaluation</strong> (<code>homoglyph</code>)</p>
<p>This rule evaluation engine attempts to detect malicious Unicode sequences as
described in the <a href="https://trojansource.codes/" target="_blank" rel="noopener noreferrer">Trojan Source attack</a>. The
homoglyphs evaluator can detect two different types of attack:</p>
<ul>
<li><code>invisible_characters</code>: using byte order characters to attempt to
confusingly display characters and comments</li>
<li><code>mixed_scripts</code>: mixing identical-appearance characters from different
alphabets (for example, to use two variables with seemingly-identical
names)</li>
</ul>
<p>The <code>homoglyph</code> evaluator only operates in a <code>pull_request</code> context using a
<code>full</code> diff.</p>
</li>
</ol>
<p>The evaluation engine determines if the rule passes, fails or should be skipped
(for example, because the resource is not the correct type). If rule passes or
is skipped, the entity is compliant with the profile, and no further evaluation
is done. If the rule evaluation fails and remediation or alerting is enabled,
output data from the rule evalution may be passed to the following steps.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="remediate">Remediate<a href="#remediate" class="hash-link" aria-label="Direct link to Remediate" title="Direct link to Remediate">​</a></h2>
<p>A rule can optionally define a
<a href="https://mindersec.github.io/ref/proto#minder-v1-RuleType-Definition-Remediate" target="_blank" rel="noopener noreferrer">remediation action</a>
to take when rule evaluation fails. The goal of remediation is to change the
state of the entity so that it it now passes the rule evaluation. The
remediation phase can optionally use inputs from the evaluation phase to
determine what actions to take.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="remediation-inputs">Remediation Inputs<a href="#remediation-inputs" class="hash-link" aria-label="Direct link to Remediation Inputs" title="Direct link to Remediation Inputs">​</a></h3>
<p>Remediation actions have access to:</p>
<ul>
<li>The <code>Entity</code> object representing the resource being evaluated</li>
<li>The <code>Profile</code> object containing rule parameters and definitions</li>
<li>For remediations which create a pull request, output from the rule evaluation
is available in <code>EvalResultOutput</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="remediation-types">Remediation Types<a href="#remediation-types" class="hash-link" aria-label="Direct link to Remediation Types" title="Direct link to Remediation Types">​</a></h3>
<p>Minder supports three remediation actions:</p>
<ol>
<li>
<p><strong>Pull Request</strong> (<code>pull_request</code>)</p>
<p>The Pull Request remediation type creates or updates GitHub pull requests to
implement fixes automatically. The pull requests are authored by the Minder
bot, and will need to be reviewed and merged by the project maintainers.</p>
<p>Pull requests support the following content modification types:</p>
<ul>
<li><code>minder.content</code>:
<a href="https://mindersec.github.io/ref/proto#minder-v1-RuleType-Definition-Remediate-PullRequestRemediation-Content" target="_blank" rel="noopener noreferrer">define a list of file <code>path</code>s and <code>content</code>s</a>
which should be updated. Currently only supports the <code>replace</code> action on
files. Both <code>path</code> and <code>content</code> may use Go templates to parameterize their
outputs</li>
<li><code>minder.actions.replace_tags_with_sha</code>: uses
<a href="https://github.com/Stacklok/frizbee" target="_blank" rel="noopener noreferrer">the Stacklok/frizbee library</a> to
resolve Git and OCI tag references to SHA digests where detected in the
repository. The only parameter to this action is a list of resources which
should not be resolved to digests (implicitly trusting the release process
for the resource)</li>
<li><code>minder.yq.evaluate</code>: applies a
<a href="https://mikefarah.gitbook.io/yq/" target="_blank" rel="noopener noreferrer">yq <code>expression</code></a> to files selected by a
list of <code>patterns</code>. Each element in the <code>patterns</code> list is represented as:
<code>{&quot;type&quot;: &quot;glob&quot;, &quot;pattern&quot;: &quot;file/path/*&quot;}</code>. <code>glob</code> is currently the only
supported pattern type. This action does not support templating either
<code>expression</code> or <code>pattern</code></li>
</ul>
<p>If the content modification produces a diff in the repository, Minder will
open and manage a pull request against the branch used in the <code>git</code> ingest,
or the default branch if a different ingestion was used. The pull request
includes the following fields which support Go templates:</p>
<ul>
<li><code>title</code>: PR title</li>
<li><code>body</code>: PR description</li>
</ul>
<p>The following data is available to fill in template contents in title, body,
and for the <code>minder.content</code> action:</p>
<ul>
<li><code>Entity</code> contains the same entity information available during rule
evaluation</li>
<li><code>Profile</code> contains the profile data supplied in the <code>def</code> field</li>
<li><code>Params</code> contains the profile data supplied in the <code>params</code> field</li>
<li><code>EvalResultOutput</code> contains the output data from the rule evaluation step</li>
</ul>
</li>
<li>
<p><strong>REST Call</strong> (<code>rest</code>)</p>
<p>The
<a href="https://mindersec.github.io/ref/proto#minder-v1-RestType" target="_blank" rel="noopener noreferrer">REST remediation</a>
calls the specified <code>endpoint</code> using the defined HTTP <code>method</code>, passing a
<code>body</code> and optional <code>headers</code>.</p>
<p>Both the endpoint and the body support Go template parameters, with the
following data:</p>
<ul>
<li><code>Entity</code> contains the same entity information available during rule
evaluation</li>
<li><code>Profile</code> contains the profile data supplied in the <code>def</code> field</li>
<li><code>Params</code> contains the profile data supplied in the <code>params</code> field</li>
</ul>
</li>
<li>
<p><strong>GitHub Branch Protection</strong> (<code>gh_branch_protect</code>)</p>
<p>The
<a href="https://mindersec.github.io/ref/proto#minder-v1-RuleType-Definition-Remediate-GhBranchProtectionType" target="_blank" rel="noopener noreferrer">branch protection remediation</a>
takes a Go-templated JSON object in <code>patch</code> to merge with the existing
protection branch protection settings. Branch protection has been implemented
as a special remediation due to the peculiarities of the GitHub branch
protection API.
<a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-rulesets/about-rulesets" target="_blank" rel="noopener noreferrer">Repository rulesets</a>
are a newer feature which avoids many of these peculiarities.</p>
<p>The <code>patch</code> string supports Go template parameters and needs to output a JSON
object which will be merged with the existing branch protection settings. The
following data is available within the Go template context:</p>
<ul>
<li><code>Entity</code> contains the same entity information available during rule
evaluation</li>
<li><code>Profile</code> contains the profile data supplied in the <code>def</code> field</li>
<li><code>Params</code> contains the profile data supplied in the <code>params</code> field</li>
</ul>
</li>
</ol>
<p>API-driven remediations (<code>rest</code> and <code>gh_branch_protect</code>) will generally take
effect immediately on the targeted entity; <code>pull_request</code> remediations will need
to be merged before they take effect. Minder will ensure that at most one pull
request is open at a time for a particular rule applied to a specific entity.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="alert-types">Alert Types<a href="#alert-types" class="hash-link" aria-label="Direct link to Alert Types" title="Direct link to Alert Types">​</a></h2>
<p>When remediation has completed, Minder will execute any
<a href="https://mindersec.github.io/ref/proto#minder-v1-RuleType-Definition-Alert" target="_blank" rel="noopener noreferrer">alerts defined for the rule type</a>.
Minder currently defines two alert types, which operate similarly to the
<a href="#remediation-types">remediation actions</a> except that alerts do not directly
attempt to fix the detected problem, but rather notify human maintainers to
allow them to evaluate the solution.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alert-inputs">Alert Inputs<a href="#alert-inputs" class="hash-link" aria-label="Direct link to Alert Inputs" title="Direct link to Alert Inputs">​</a></h3>
<p>Because alerts are primarily indended to drive later human behavior, they have
limited processing functionality. Alerts have access to:</p>
<ul>
<li>Whether a remediation rule is defined for <code>security_advisory</code> alerts</li>
<li>Output from the rule evaluation as <code>EvalResultOutput</code> for
<code>pull_request_comment</code>s</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alert-types-1">Alert Types<a href="#alert-types-1" class="hash-link" aria-label="Direct link to Alert Types" title="Direct link to Alert Types">​</a></h3>
<ol>
<li>
<p><strong>Pull Request Comments</strong> (<code>pull_request_comment</code>)</p>
<p>Instructs Minder to comment on new and updated pull requests. Minder will
ensure that each PR in a repository has at most one comment per rule type
evaluated, and will delete the PR comment if the pull request rule evaluation
succeeds in the future (for example, because the flagged issue was
addressed).</p>
<p>Pull request comments have a single <code>review_message</code> parameter, which
contains a Go templated markdown string with the following contents from the
rule evaluation:</p>
<ul>
<li><code>EvalErrorDetails</code> contains any detailed error messages from the rule
evaluation execution</li>
<li><code>EvalResultOutput</code> contains the output data from the rule evaluation step</li>
</ul>
<p>The <code>pull_request_comment</code> alert type is only valid on pull request entities.</p>
</li>
<li>
<p><strong>GitHub Security Alerts</strong> (<code>security_alert</code>)</p>
<p>This rule instructs Minder to create a
<a href="https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability" target="_blank" rel="noopener noreferrer">private security vulnerability report</a>
through the GitHub API, assuming that private vulnerability reporting is
enabled for the repository. These reports require administrator permission to
view. When the security alert is no longer active because the rule evaluation
passes or is skipped, Minder will automatically close the security
vulnerability.</p>
<p>The contents of the security advisory are currently hard-coded, and include
the following details:</p>
<ul>
<li>Rule evaluation error message</li>
<li>Repository name</li>
<li>Profile and rule name which was</li>
<li>Rule severity from the rule type definition</li>
<li>Any [<code>guidance</code>] content from the rule type definition</li>
</ul>
</li>
</ol></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ref/schema"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Minder database schema</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/about/changelog"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Changelog</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ingest" class="table-of-contents__link toc-highlight">Ingest</a><ul><li><a href="#input-sources" class="table-of-contents__link toc-highlight">Input Sources:</a></li><li><a href="#ingest-types-and-their-outputs" class="table-of-contents__link toc-highlight">Ingest Types and Their Outputs</a></li></ul></li><li><a href="#evaluate" class="table-of-contents__link toc-highlight">Evaluate</a><ul><li><a href="#evaluation-process" class="table-of-contents__link toc-highlight">Evaluation Process</a></li></ul></li><li><a href="#remediate" class="table-of-contents__link toc-highlight">Remediate</a><ul><li><a href="#remediation-inputs" class="table-of-contents__link toc-highlight">Remediation Inputs</a></li><li><a href="#remediation-types" class="table-of-contents__link toc-highlight">Remediation Types</a></li></ul></li><li><a href="#alert-types" class="table-of-contents__link toc-highlight">Alert Types</a><ul><li><a href="#alert-inputs" class="table-of-contents__link toc-highlight">Alert Inputs</a></li><li><a href="#alert-types-1" class="table-of-contents__link toc-highlight">Alert Types</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Minder</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/mindersec/minder" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Minder a Series of LF Projects, LLC
For web site terms of use, trademark policy and other project policies please see https://lfprojects.org.</div></div></div></footer></div>
</body>
</html>